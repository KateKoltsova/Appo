import{r as g,_ as P,k as L,l as E,e as o,c as n,a as e,t as m,b as N,F as M,m as Y,g as F,n as U,q as b,o as H,d as B,w as q,s as z,p as G,h as j}from"./app.50c87d8e.js";import{a as J,u as K,L as Q}from"./LoadingSpinner.3b2823d8.js";function V(){const d=g(new Date),i=g([]);return{selectedDate:d,displayedDates:i,getDateWithOffset:(a=new Date,k=0)=>{const t=new Date(a);t.setDate(t.getDate()+k);const l=[];for(let h=-3;h<=3;h++){const s=new Date(t);s.setDate(t.getDate()+h),l.push(s)}return{newDate:t,days:l}}}}const X={class:"calendar-header"},Z={key:0,class:"year-scroll"},ee={class:"year-options"},te=["onClick"],se={class:"calendar-grid"},ae=["onClick"],oe={__name:"CalendarModal",props:{isOpen:Boolean,selectedDate:Date},emits:["close","dateSelected"],setup(d,{emit:i}){const u=d,a=i;V();const k=new Date,t=g(u.selectedDate.getMonth()),l=g(u.selectedDate.getFullYear()),h=g(!1),s=g([]),f=g(l.value),c=L(()=>{const r=new Date(l.value,t.value,1),C=new Date(l.value,t.value+1,0),_=(r.getDay()+6)%7,S=[];for(let y=0;y<_;y++)S.push(new Date(r.getFullYear(),r.getMonth(),1-_+y));for(let y=new Date(r);y<=C;y.setDate(y.getDate()+1))S.push(new Date(y));const x=7,A=S.length,I=x-A%x;if(I<x)for(let y=1;y<=I;y++)S.push(new Date(C.getFullYear(),C.getMonth(),C.getDate()+y));return S}),$=L(()=>new Date(l.value,t.value).toLocaleDateString("ru-RU",{month:"long"})),v=L(()=>l.value),p=()=>{s.value=[];for(let r=f.value;r<=f.value+3;r++)s.value.push(r)},w=r=>{l.value=r,p(),h.value=!1};E(()=>u.selectedDate,r=>{t.value=r.getMonth(),l.value=r.getFullYear()},p());const D=r=>{r>=k&&(a("dateSelected",r),a("close"))},O=()=>{t.value===0?(t.value=11,l.value--):t.value--,p()},R=()=>{t.value===11?(t.value=0,l.value++):t.value++,p()},W=()=>{a("close")};return(r,C)=>u.isOpen?(o(),n("div",{key:0,class:"modal-overlay",onClick:W},[e("div",{class:"modal-content",onClick:C[2]||(C[2]=N(()=>{},["stop"]))},[e("div",X,[e("button",{class:"month-button",onClick:O},"<"),e("h2",null,m($.value),1),e("div",{class:"year-picker",onClick:C[1]||(C[1]=N(()=>{},["stop"]))},[e("span",{onClick:C[0]||(C[0]=_=>h.value=!h.value)},m(v.value),1),h.value?(o(),n("div",Z,[e("div",ee,[(o(!0),n(M,null,Y(s.value,_=>(o(),n("div",{key:_,onClick:S=>w(_)},m(_),9,te))),128))])])):F("",!0)]),e("button",{class:"month-button",onClick:R},">")]),e("div",se,[(o(!0),n(M,null,Y(c.value,_=>(o(),n("div",{key:_,class:U(["calendar-day",{selected:_.getDate()===u.selectedDate.getDate()&&_.getMonth()===t.value&&_.getFullYear()===l.value,disabled:_.getTime()<b(k).setHours(0,0,0,0)||_.getMonth()!==t.value}]),onClick:S=>D(_)},m(_.getDate()),11,ae))),128))])])])):F("",!0)}},ne=P(oe,[["__scopeId","data-v-481ee26d"]]);const le={class:"date-carousel"},ce={class:"dates"},ie=["onClick"],re={class:"day-name"},de={class:"day-number"},ue={class:"month-name"},_e={__name:"DateCarousel",emits:["dateSelection"],setup(d,{emit:i}){const u=i,{selectedDate:a,displayedDates:k,getDateWithOffset:t}=V(),l=new Date,h=g(!1);H(()=>{s(l,0)});const s=(p,w)=>{p.value=new Date(p);const{newDate:D,days:O}=t(p.value,w);a.value=D,k.value=O,$(),u("dateSelection",a.value)},f=p=>(p.value=new Date(p),p.getTime()<l.setHours(0,0,0,0)),c=()=>{h.value=!0},$=()=>{h.value=!1},v=L(()=>a.value.toLocaleDateString("ru-RU",{month:"long",year:"numeric"}));return(p,w)=>(o(),n(M,null,[e("button",{class:"open-calendar-button",onClick:c},m(v.value),1),B(ne,{isOpen:h.value,selectedDate:b(a),onClose:$,onDateSelected:s},null,8,["isOpen","selectedDate"]),e("div",le,[e("button",{onClick:w[0]||(w[0]=D=>s(b(a),-1))},"<"),e("div",ce,[(o(!0),n(M,null,Y(b(k),D=>(o(),n("div",{key:D,class:U(["date-card",{active:D.getTime()===b(a).getTime(),disabled:f(D)}]),onClick:O=>s(D)},[e("div",re,m(D.toLocaleDateString("ru-RU",{weekday:"short"})),1),e("div",de,m(D.getDate()),1),e("div",ue,m(D.toLocaleDateString("ru-RU",{month:"short"})),1)],10,ie))),128))]),e("button",{onClick:w[1]||(w[1]=D=>s(b(a),1))},">")])],64))}},ve=P(_e,[["__scopeId","data-v-6fe28ae0"]]),he=async(d=null)=>{try{let i={};return d&&(i={filter:{date:[pe(d)]}}),await J({url:K.schedules.availableSchedules.url,method:"GET",params:i})}catch(i){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u043E\u0433\u043E \u0440\u0430\u0441\u043F\u0438\u0441\u0430\u043D\u0438\u044F",i),i}},pe=d=>{const i=d.getFullYear(),u=String(d.getMonth()+1).padStart(2,"0"),a=String(d.getDate()).padStart(2,"0");return`${i}-${u}-${a}`};const T=d=>(G("data-v-41fd72e6"),d=d(),j(),d),De={key:0},ge={class:"card-container"},me={class:"card-header"},fe={class:"master-info"},ye={class:"first-name"},ke={class:"last-name"},Ce={class:"schedule"},$e={class:"time"},we={class:"service-selection"},Se=T(()=>e("label",{for:"services"},"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0441\u043B\u0443\u0433\u0443:",-1)),Me=["onUpdate:modelValue","onChange"],be=T(()=>e("option",{disabled:"",value:""},"-- \u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0441\u043B\u0443\u0433\u0443 --",-1)),Ye=["value"],Oe={key:0},Le=["onClick"],xe={key:1},Fe=T(()=>e("p",null,"No schedules available for the selected date.",-1)),Be=[Fe],Pe={__name:"BookingPage",setup(d){const i=g(!1);g([]);const u=g([]),a=g({}),k=g({}),t=async s=>{try{i.value=!0;const f=await he(s);if(f.status==200){const c=await f.data.data;u.value=c}else console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u043E\u0433\u043E \u0440\u0430\u0441\u043F\u0438\u0441\u0430\u043D\u0438\u044F",error)}catch(f){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0440\u0430\u0441\u043F\u0438\u0441\u0430\u043D\u0438\u0439:",f)}i.value=!1},l=s=>{const f=a.value[s],$=u.value.find(v=>v.master_id===s).prices.find(v=>v.title===f);k.value[s]=$?$.price:void 0},h=s=>{console.log(`\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u043E \u0432 \u043A\u043E\u0440\u0437\u0438\u043D\u0443: \u041C\u0430\u0441\u0442\u0435\u0440 ID ${s}, \u0423\u0441\u043B\u0443\u0433\u0430 ${a.value[s]}`)};return(s,f)=>(o(),n("div",null,[B(ve,{onDateSelection:t}),B(Q,{isLoading:i.value},null,8,["isLoading"]),u.value.length?(o(),n("div",De,[(o(!0),n(M,null,Y(u.value,c=>(o(),n("div",{key:c.master_id},[(o(!0),n(M,null,Y(c.schedules,$=>(o(),n("div",{key:$.schedule_id,class:"card"},[e("div",ge,[e("div",me,[e("div",fe,[e("h2",ye,m(c.master_firstname),1),e("h3",ke,m(c.master_lastname),1)]),e("div",Ce,[e("span",$e,m($.date_time),1)])]),e("div",we,[Se,q(e("select",{"onUpdate:modelValue":v=>a.value[c.master_id]=v,onChange:v=>l(c.master_id)},[be,(o(!0),n(M,null,Y(c.prices,v=>(o(),n("option",{key:v.price_id,value:v.title},m(v.title),9,Ye))),128))],40,Me),[[z,a.value[c.master_id]]]),k.value[c.master_id]!==void 0?(o(),n("span",Oe,m(k.value[c.master_id])+" \u0433\u0440\u043D. ",1)):F("",!0),e("button",{onClick:v=>h(c.master_id)}," \u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432 \u043A\u043E\u0440\u0437\u0438\u043D\u0443 ",8,Le)])])]))),128))]))),128))])):(o(),n("div",xe,Be))]))}},Ne=P(Pe,[["__scopeId","data-v-41fd72e6"]]);export{Ne as default};
