import{_ as S,e as v,c as g,a,w as d,v as u,b as _,n as I,p as L,h as w,r as f,i as x,j as O,o as V,d as b,t as p,u as B}from"./app.50c87d8e.js";import{a as U,u as y,L as j}from"./LoadingSpinner.3b2823d8.js";const F=async e=>{try{return await U({url:y.users.byId.url(e),method:"GET"})}catch(o){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0434\u0430\u043D\u043D\u044B\u0445 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F",o),o}},N=async(e,o)=>{try{return await U({url:y.users.byId.url(e),method:"PATCH",data:o})}catch(s){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u0434\u0430\u043D\u043D\u044B\u0445 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F",s),s}},h={id:null,firstname:"",lastname:"",birthdate:"",email:"",phone_number:"",role_id:null,role:"",image_url:""};const c=e=>(L("data-v-d6295bde"),e=e(),w(),e),k=c(()=>a("label",{for:"firstname"},"FirstName:",-1)),M=c(()=>a("label",{for:"lastname"},"Lastname:",-1)),C=c(()=>a("label",{for:"birthdate"},"Birthdate:",-1)),D=c(()=>a("label",{for:"email"},"Email:",-1)),E=c(()=>a("label",{for:"phone_number"},"Phone number:",-1)),P=["disabled"],T={__name:"UserForm",props:{editedUser:Object,isLoading:Boolean},emits:["onSave"],setup(e,{emit:o}){const s=o,l=()=>{s("onSave")};return(m,r)=>(v(),g("form",{onSubmit:_(l,["prevent"]),class:I({disabled:e.isLoading})},[a("div",null,[k,d(a("input",{type:"text",id:"firstname","onUpdate:modelValue":r[0]||(r[0]=t=>e.editedUser.firstname=t)},null,512),[[u,e.editedUser.firstname]])]),a("div",null,[M,d(a("input",{type:"text",id:"lastname","onUpdate:modelValue":r[1]||(r[1]=t=>e.editedUser.lastname=t)},null,512),[[u,e.editedUser.lastname]])]),a("div",null,[C,d(a("input",{type:"date",id:"birthdate","onUpdate:modelValue":r[2]||(r[2]=t=>e.editedUser.birthdate=t)},null,512),[[u,e.editedUser.birthdate]])]),a("div",null,[D,d(a("input",{type:"email",id:"email","onUpdate:modelValue":r[3]||(r[3]=t=>e.editedUser.email=t)},null,512),[[u,e.editedUser.email]])]),a("div",null,[E,d(a("input",{type:"tel",id:"phone_number","onUpdate:modelValue":r[4]||(r[4]=t=>e.editedUser.phone_number=t)},null,512),[[u,e.editedUser.phone_number]])]),a("button",{type:"submit",disabled:e.isLoading},"Save",8,P)],34))}},A=S(T,[["__scopeId","data-v-d6295bde"]]),z={__name:"UserProfile",setup(e){const o=f({...h}),s=x({...h}),l=f(!1);B(),O(),V(async()=>{l.value=!0;const t=localStorage.getItem("userId"),i=localStorage.getItem("user");if(i)m(JSON.parse(i));else try{const n=await F(t);n.status===200?m(n.data.data):console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0434\u0430\u043D\u043D\u044B\u0445 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F")}catch(n){console.error(n)}l.value=!1});const m=t=>{Object.assign(o.value,t),Object.assign(s,t),localStorage.setItem("user",JSON.stringify(t))},r=async()=>{l.value=!0;const t=localStorage.getItem("userId"),i={};for(const n in s)s[n]!==o.value[n]&&(i[n]=s[n]);if(Object.keys(i).length===0){console.log("\u041D\u0435\u0442 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0439 \u0434\u043B\u044F \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F"),l.value=!1;return}try{(await N(t,i)).status===200?m(s):console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u0434\u0430\u043D\u043D\u044B\u0445 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F")}catch(n){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u0435\u0442\u0438:",n)}l.value=!1};return(t,i)=>(v(),g("div",null,[b(j,{isLoading:l.value},null,8,["isLoading"]),a("h2",null,"Hello, user "+p(s==null?void 0:s.firstname)+" "+p(s==null?void 0:s.lastname),1),b(A,{editedUser:s,isLoading:l.value,onOnSave:r},null,8,["editedUser","isLoading"])]))}};export{z as default};
